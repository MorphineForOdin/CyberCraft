--============================================================================
USE TechMarket;
GO
--============================================================================
MERGE dbo.ProductsAttributesValues AS target
    USING (VALUES 
            (1, 1, 1),
            (1, 2, 8),
            (1, 4, 25),
            (2, 1, 2),
            (2, 2, 8),
            (2, 4, 26),
            (3, 1, 3),
            (3, 2, 8),
            (3, 4, 27),
            (4, 1, 4),
            (4, 2, 9),
            (4, 4, 27),
            (5, 1, 1),
            (5, 2, 9),
            (5, 4, 25),
            (6, 1, 5),
            (6, 2, 10),
            (6, 4, 25),
            (7, 1, 2),
            (7, 2, 10),
            (7, 4, 26),
            (8, 1, 2),
            (8, 2, 11),
            (8, 4, 25),
            (9, 1, 6),
            (9, 2, 8),
            (9, 4, 26),
            (10, 1, 1),
            (10, 2, 8),
            (10, 4, 27),
            (11, 1, 7),
            (11, 2, 12),
            (11, 3, 21),
            (11, 4, 26),
            (12, 1, 2),
            (12, 2, 12),
            (12, 3, 21),
            (12, 4, 26),
            (13, 1, 7),
            (13, 2, 12),
            (13, 3, 21),
            (13, 4, 25),
            (14, 1, 2),
            (14, 2, 12),
            (14, 3, 22),
            (14, 4, 27),
            (15, 1, 7),
            (15, 2, 13),
            (15, 3, 22),
            (15, 4, 27),
            (16, 1, 7),
            (16, 2, 14),
            (16, 3, 23),
            (16, 4, 29),
            (16, 5, 31),
            (17, 1, 4),
            (17, 2, 14),
            (17, 3, 22),
            (17, 4, 27),
            (17, 5, 31),
            (18, 1, 7),
            (18, 2, 25),
            (18, 3, 23),
            (18, 4, 29),
            (18, 5, 32),
            (19, 1, 1),
            (19, 2, 16),
            (19, 3, 24),
            (19, 4, 30),
            (19, 5, 34),
            (20, 1, 7),
            (20, 2, 16),
            (20, 3, 23),
            (20, 4, 28),
            (20, 5, 33),
            (21, 1, 7),
            (21, 2, 17),
            (21, 3, 21),
            (21, 4, 26),
            (22, 1, 1),
            (22, 2, 17),
            (22, 3, 21),
            (22, 4, 27),
            (23, 1, 1),
            (23, 2, 18),
            (23, 4, 25),
            (24, 1, 1),
            (24, 2, 19),
            (24, 4, 27),
            (25, 1, 7),
            (25, 2, 20),
            (25, 4, 26)) 
            AS source ([ProductId], [AttributeId], [ValueId])
    ON (target.[ProductId] = source.[ProductId])
    WHEN MATCHED
        THEN UPDATE SET 
            target.[AttributeId] = source.[AttributeId],
            target.[ValueId] = source.[ValueId]
    WHEN NOT MATCHED BY target
        THEN INSERT (
            [ProductId],
            [AttributeId],
            [ValueId])
        VALUES (
            source.[ProductId],
            source.[AttributeId],
            source.[ValueId])
    WHEN NOT MATCHED BY source
        THEN DELETE;
--============================================================================